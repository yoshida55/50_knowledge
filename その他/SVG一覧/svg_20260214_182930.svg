<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>スクロールアニメーション解説</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "游ゴシック体", YuGothic, "游ゴシック", "Yu Gothic", sans-serif;
            line-height: 1.8;
            color: #333;
            background-color: #EBF1F6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #5A8FC4 0%, #7AB693 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 12px;
            margin-bottom: 40px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        h2 {
            color: #5A8FC4;
            font-size: 1.8em;
            margin: 50px 0 25px 0;
            padding-bottom: 12px;
            border-bottom: 3px solid #7AB693;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            color: #5A8FC4;
            font-size: 1.3em;
            margin: 30px 0 15px 0;
        }

        .info-box {
            background: white;
            border-left: 5px solid #7AB693;
            padding: 20px 25px;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .info-box strong {
            color: #5A8FC4;
            font-size: 1.1em;
        }

        .warning-box {
            background: #FFF9E6;
            border-left: 5px solid #E8A87C;
            padding: 20px 25px;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .svg-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow-x: auto;
        }

        .svg-container svg {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #5A8FC4;
            color: white;
            font-weight: bold;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            position: relative;
            overflow-x: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .code-block pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #7AB693;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.3s;
        }

        .copy-btn:hover {
            background: #6AA583;
        }

        .summary {
            background: linear-gradient(135deg, #7AB693 0%, #5A8FC4 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin: 50px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .summary h2 {
            color: white;
            border-bottom: 3px solid white;
            margin-top: 0;
        }

        .summary ul {
            margin: 20px 0 0 25px;
        }

        .summary li {
            margin: 12px 0;
            font-size: 1.05em;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        .comparison-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .comparison-item h4 {
            color: #5A8FC4;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            header h1 {
                font-size: 1.6em;
            }

            h2 {
                font-size: 1.5em;
            }

            .comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🎯 スクロールアニメーション</h1>
            <p>rect.topの仕組みと判定条件を図解で理解する</p>
        </header>

        <section>
            <h2>📊 rect.topの意味</h2>
            <div class="info-box">
                <strong>rect.top</strong> = 画面の上端（0px）から要素の上端までの距離<br>
                <strong>重要:</strong> スクロールするほど <code>rect.top</code> は減少します。つまり「スクロールした位置からの要素までの距離」を表します。
            </div>

            <div class="svg-container">
                <svg viewBox="0 0 700 400" xmlns="http://www.w3.org/2000/svg">
                    <!-- 左側：スクロール前 -->
                    <text x="80" y="25" font-size="18" font-weight="bold" fill="#5A8FC4">スクロール前</text>
                    
                    <!-- 画面 -->
                    <rect x="30" y="50" width="200" height="300" fill="none" stroke="#5A8FC4" stroke-width="3"/>
                    <text x="40" y="70" font-size="14" fill="#333">画面上端 0px</text>
                    <line x1="40" y1="75" x2="220" y2="75" stroke="#E8A87C" stroke-width="2"/>
                    
                    <!-- 画面下端 -->
                    <text x="40" y="345" font-size="14" fill="#333">画面下端 800px</text>
                    <line x1="40" y1="330" x2="220" y2="330" stroke="#E8A87C" stroke-width="2"/>
                    
                    <!-- 要素（画面外） -->
                    <rect x="80" y="360" width="100" height="30" fill="#7AB693" opacity="0.5"/>
                    <text x="95" y="380" font-size="16" fill="white">📦 要素</text>
                    
                    <!-- 矢印と距離 -->
                    <line x1="250" y1="75" x2="250" y2="365" stroke="#E8A87C" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="260" y="220" font-size="16" font-weight="bold" fill="#E8A87C">rect.top</text>
                    <text x="260" y="240" font-size="16" font-weight="bold" fill="#E8A87C">1200px</text>
                    <text x="260" y="260" font-size="14" fill="#999">(遠い ❌)</text>
                    
                    <!-- 右側：スクロール後 -->
                    <text x="480" y="25" font-size="18" font-weight="bold" fill="#5A8FC4">スクロール後</text>
                    
                    <!-- 画面 -->
                    <rect x="430" y="50" width="200" height="300" fill="none" stroke="#5A8FC4" stroke-width="3"/>
                    <text x="440" y="70" font-size="14" fill="#333">画面上端 0px</text>
                    <line x1="440" y1="75" x2="620" y2="75" stroke="#E8A87C" stroke-width="2"/>
                    
                    <!-- 要素（画面内） -->
                    <rect x="480" y="200" width="100" height="30" fill="#7AB693"/>
                    <text x="495" y="220" font-size="16" fill="white">📦 要素</text>
                    
                    <!-- 画面下端 -->
                    <text x="440" y="345" font-size="14" fill="#333">画面下端 800px</text>
                    <line x1="440" y1="330" x2="620" y2="330" stroke="#E8A87C" stroke-width="2"/>
                    
                    <!-- 矢印と距離 -->
                    <line x1="650" y1="75" x2="650" y2="205" stroke="#7AB693" stroke-width="2" marker-end="url(#arrowhead2)"/>
                    <text x="660" y="135" font-size="16" font-weight="bold" fill="#7AB693">rect.top</text>
                    <text x="660" y="155" font-size="16" font-weight="bold" fill="#7AB693">600px</text>
                    <text x="660" y="175" font-size="14" fill="#7AB693">(近い ✅)</text>
                    
                    <!-- 矢印定義 -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#E8A87C"/>
                        </marker>
                        <marker id="arrowhead2" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#7AB693"/>
                        </marker>
                    </defs>
                </svg>
            </div>
        </section>

        <section>
            <h2>🔍 値の変化</h2>
            <p>スクロール量に応じて <code>rect.top</code> がどう変化するかを確���しましょう。</p>

            <table>
                <thead>
                    <tr>
                        <th>スクロール量</th>
                        <th>rect.top</th>
                        <th>状態</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>0px</td>
                        <td>1200px</td>
                        <td>画面外 ❌</td>
                    </tr>
                    <tr>
                        <td>400px</td>
                        <td>800px</td>
                        <td>画面下端 ⚠️</td>
                    </tr>
                    <tr>
                        <td>600px</td>
                        <td>600px</td>
                        <td>画面内 ✅</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>⚠️ ポイント:</strong> スクロールするほど <code>rect.top</code> は減少します。要素が画面に近づくと値が小さくなります。
            </div>
        </section>

        <section>
            <h2>✅ 判定条件</h2>
            <p>要素が画面内に入ったかどうかを判定するコードです。</p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">コピー</button>
                <pre>if (rect.top <= windowHeight) {
  element.classList.add('animate');
}</pre>
            </div>

            <div class="info-box">
                <strong>判定ロジック:</strong><br>
                <code>rect.top</code>（要素までの距離）が <code>windowHeight</code>（画面の高さ）以下になったら、要素が画面内に入ったと判定します。
            </div>

            <div class="svg-container">
                <svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- 条件分岐 -->
                    <rect x="50" y="50" width="200" height="80" fill="#5A8FC4" rx="8"/>
                    <text x="150" y="85" font-size="16" fill="white" text-anchor="middle" font-weight="bold">rect.top ≤ windowHeight</text>
                    <text x="150" y="110" font-size="14" fill="white" text-anchor="middle">600px ≤ 800px ?</text>
                    
                    <!-- true矢印 -->
                    <line x1="250" y1="90" x2="350" y2="90" stroke="#7AB693" stroke-width="3" marker-end="url(#arrowGreen)"/>
                    <text x="300" y="80" font-size="14" fill="#7AB693" font-weight="bold">true</text>
                    
                    <!-- アニメーション発動 -->
                    <rect x="350" y="50" width="200" height="80" fill="#7AB693" rx="8"/>
                    <text x="450" y="85" font-size="16" fill="white" text-anchor="middle" font-weight="bold">アニメーション発動！</text>
                    <text x="450" y="110" font-size="14" fill="white" text-anchor="middle">.addClass('animate')</text>
                    
                    <!-- false矢印 -->
                    <line x1="150" y1="130" x2="150" y2="200" stroke="#E8A87C" stroke-width="3" marker-end="url(#arrowOrange)"/>
                    <text x="160" y="165" font-size="14" fill="#E8A87C" font-weight="bold">false</text>
                    
                    <!-- 何もしない -->
                    <rect x="50" y="200" width="200" height="60" fill="#E8A87C" rx="8"/>
                    <text x="150" y="235" font-size="16" fill="white" text-anchor="middle" font-weight="bold">何もしない</text>
                    
                    <!-- 矢印定義 -->
                    <defs>
                        <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#7AB693"/>
                        </marker>
                        <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="5" refY="9" orient="auto">
                            <polygon points="0 0, 5 10, 10 0" fill="#E8A87C"/>
                        </marker>
                    </defs>
                </svg>
            </div>
        </section>

        <section>
            <h2>📌 重要な値</h2>
            <p>スクロールアニメーションで使用する3つの重要な値を理解しましょう。</p>

            <table>
                <thead>
                    <tr>
                        <th>変数</th>
                        <th>意味</th>
                        <th>変動</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>window.innerHeight</code></td>
                        <td>ブラウザの見える範囲の高さ</td>
                        <td>固定</td>
                    </tr>
                    <tr>
                        <td><code>window.scrollY</code></td>
                        <td>スクロールした距離</td>
                        <td>変動</td>
                    </tr>
                    <tr>
                        <td><code>rect.top</code></td>
                        <td>画面上端から要素上端までの距離</td>
                        <td>変動</td>
                    </tr>
                </tbody>
            </table>

            <div class="comparison">
                <div class="comparison-item">
                    <h4>固定値</h4>
                    <p><strong>window.innerHeight</strong></p>
                    <p>ブラウザウィンドウのサイズが変わらない限り固定。通常800px程度（デバイス依存）。</p>
                </div>
                <div class="comparison-item">
                    <h4>変動値</h4>
                    <p><strong>rect.top / scrollY</strong></p>
                    <p>ユーザーがスクロールすると常に変化。これを監視してアニメーションを発動させます。</p>
                </div>
            </div>
        </section>

        <section>
            <h2>🎬 動作イメージ</h2>
            <p>実際のスクロール動作を視覚的に理解しましょう。</p>

            <div class="svg-container">
                <svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
                    <!-- タイトル -->
                    <text x="100" y="30" font-size="18" font-weight="bold" fill="#5A8FC4">スクロール前</text>
                    <text x="500" y="30" font-size="18" font-weight="bold" fill="#5A8FC4">スクロール後</text>
                    
                    <!-- 左：スクロール前 -->
                    <g>
                        <!-- ブラウザ枠 -->
                        <rect x="50" y="60" width="250" height="350" fill="#f0f0f0" stroke="#5A8FC4" stroke-width="3" rx="5"/>
                        <rect x="50" y="60" width="250" height="30" fill="#5A8FC4"/>
                        <text x="175" y="82" font-size="14" fill="white" text-anchor="middle">ブラウザ</text>
                        
                        <!-- 画面上端 -->
                        <line x1="60" y1="100" x2="290" y2="100" stroke="#E8A87C" stroke-width="2"/>
                        <text x="310" y="105" font-size="12" fill="#E8A87C">0px</text>
                        
                        <!-- innerHeight範囲 -->
                        <rect x="60" y="100" width="230" height="280" fill="none" stroke="#7AB693" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="65" y="120" font-size="12" fill="#7AB693" font-weight="bold">innerHeight: 800px</text>
                        
                        <!-- 画面下端 -->
                        <line x1="60" y1="380" x2="290" y2="380" stroke="#E8A87C" stroke-width="2"/>
                        <text x="310" y="385" font-size="12" fill="#E8A87C">800px</text>
                        
                        <!-- スクロール可能領域 -->
                        <line x1="60" y1="390" x2="290" y2="390" stroke="#ccc" stroke-width="1" stroke-dasharray="3,3"/>
                        
                        <!-- 要素（画面外） -->
                        <rect x="120" y="430" width="110" height="40" fill="#7AB693" opacity="0.4" rx="5"/>
                        <text x="175" y="455" font-size="14" fill="white" text-anchor="middle">📦 要素</text>
                        
                        <!-- rect.top矢印 -->
                        <line x1="330" y1="100" x2="330" y2="435" stroke="#E8A87C" stroke-width="2" marker-end="url(#arrow1)"/>
                        <text x="340" y="270" font-size="14" fill="#E8A87C" font-weight="bold">rect.top</text>
                        <text x="340" y="290" font-size="14" fill="#E8A87C" font-weight="bold">1200px</text>
                        
                        <!-- ���定結果 -->
                        <rect x="80" y="485" width="180" height="5" fill="#E8A87C" rx="2"/>
                        <text x="170" y="505" font-size="12" fill="#E8A87C" text-anchor="middle" font-weight="bold">1200 > 800 ❌</text>
                    </g>
                    
                    <!-- 右：スクロール後 -->
                    <g>
                        <!-- ブラウザ枠 -->
                        <rect x="450" y="60" width="250" height="350" fill="#f0f0f0" stroke="#5A8FC4" stroke-width="3" rx="5"/>
                        <rect x="450" y="60" width="250" height="30" fill="#5A8FC4"/>
                        <text x="575" y="82" font-size="14" fill="white" text-anchor="middle">ブラウザ</text>
                        
                        <!-- 画面上端 -->
                        <line x1="460" y1="100" x2="690" y2="100" stroke="#E8A87C" stroke-width="2"/>
                        <text x="710" y="105" font-size="12" fill="#E8A87C">0px</text>
                        
                        <!-- innerHeight範囲 -->
                        <rect x="460" y="100" width="230" height="280" fill="none" stroke="#7AB693" stroke-width="2" stroke-dasharray="5,5"/>
                        
                        <!-- 要素（画面内） -->
                        <rect x="520" y="250" width="110" height="40" fill="#7AB693" rx="5"/>
                        <text x="575" y="275" font-size="14" fill="white" text-anchor="middle">📦 要素</text>
                        
                        <!-- 画面下端 -->
                        <line x1="460" y1="380" x2="690" y2="380" stroke="#E8A87C" stroke-width="2"/>
                        <text x="710" y="385" font-size="12" fill="#E8A87C">800px</text>
                        
                        <!-- rect.top矢印 -->
                        <line x1="730" y1="100" x2="730" y2="255" stroke="#7AB693" stroke-width="2" marker-end="url(#arrow2)"/>
                        <text x="740" y="170" font-size="14" fill="#7AB693" font-weight="bold">rect.top</text>
                        <text x="740" y="190" font-size="14" fill="#7AB693" font-weight="bold">600px</text>
                        
                        <!-- 判定結果 -->
                        <rect x="480" y="485" width="180" height="5" fill="#7AB693" rx="2"/>
                        <text x="570" y="505" font-size="12" fill="#7AB693" text-anchor="middle" font-weight="bold">600 ≤ 800 ✅</text>
                    </g>
                    
                    <!-- 矢印マーカー -->
                    <defs>
                        <marker id="arrow1" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#E8A87C"/>
                        </marker>
                        <marker id="arrow2" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#7AB693"/>
                        </marker>
                    </defs>
                </svg>
            </div>

            <div class="info-box">
                <strong>600 ≤ 800 → true → アニメーション発動！</strong><br>
                要素の上端が画面の下端（800px）よりも上にある（600px）ので、条件を満たしてアニメーションが発動します。
            </div>
        </section>

        <section>
            <h2>💡 実装例</h2>
            <p>実際のJavaScriptコードでスクロールアニメーションを実装する方法です。</p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">コピー</button>
                <pre>// スクロールイ��ントを監視
window.addEventListener('scroll', function() {
  // アニメーション対象の要素を取得
  const elements = document.querySelectorAll('.animate-target');
  
  // ブラウザの高さを取得
  const windowHeight = window.innerHeight;
  
  elements.forEach(element => {
    // 要素の位置情報を取得
    const rect = element.getBoundingClientRect();
    
    // 要素が画面内に入ったか判定
    if (rect.top <= windowHeight) {
      element.classList.add('animate');
    }
  });
});</pre>
            </div>

            <h3>CSSアニメーション例</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">コピー</button>
                <pre>.animate-target {
  opacity: 0;
  transform: translateY(50px);
  transition: all 0.8s ease;
}

.animate-target.animate {
  opacity: 1;
  transform: translateY(0);
}</pre>
            </div>
        </section>

        <section>
            <h2>🔧 デモファイル</h2>
            <div class="info-box">
                <strong>リアルタイムで値を確認可能:</strong><br>
                <a href="../02_作業/00_リンクワーク/HTML自動化/過去の課題/67_猫サイト/scroll-demo.html" style="color: #5A8FC4; font-weight: bold;">scroll-demo.html</a><br>
                このデモファイルでは、スクロール時の <code>rect.top</code>、<code>scrollY</code>、<code>innerHeight</code> の値をリアルタイムで確認できます。
            </div>
        </section>

        <div class="summary">
            <h2>📚 まとめ</h2>
            <ul>
                <li><strong>rect.top</strong>: 画面上端から要素上端までの距離（スクロールで減少）</li>
                <li><strong>window.innerHeight</strong>: ブラウザの見える高さ（固定）</li>
                <li><strong>判定条件</strong>: <code>rect.top ≤ windowHeight</code> で画面内判定</li>
                <li><strong>アニメーション発動</strong>: 条件を満たしたら <code>.animate</code> クラスを追加</li>
                <li><strong>本棚の例え</strong>: スクロールは「本棚の前を歩く」こと。<code>rect.top</code> は「目の前の本までの距離」。近づく（値が小さくなる）と本が見える（アニメーション発動）！</li>
            </ul>
        </div>
    </div>

    <script>
        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'コピー完了！';
                setTimeout(() => {
                    button.textContent = 'コピー';
                }, 2000);
            });
        }
    </script>
</body>
</html