<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 900">
  <!-- タイトル -->
  <text x="400" y="30" font-size="20" font-weight="bold" text-anchor="middle">バブルソート(昇順)の仕組み</text>
  
  <!-- 初期状態 -->
  <text x="50" y="70" font-size="16" font-weight="bold">初期配列: [5, 3, 8, 1, 4]</text>
  
  <!-- 外側ループ i=0 -->
  <text x="50" y="110" font-size="14" fill="#0066cc" font-weight="bold">■ 外側ループ i=0 (1周目)</text>
  
  <!-- j=0 -->
  <text x="70" y="140" font-size="12">j=0: 比較 [5 vs 3]</text>
  <rect x="100" y="150" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="120" y="170" font-size="14" text-anchor="middle">5</text>
  <rect x="150" y="150" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="170" y="170" font-size="14" text-anchor="middle">3</text>
  <rect x="200" y="150" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="220" y="170" font-size="14" text-anchor="middle">8</text>
  <rect x="250" y="150" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="270" y="170" font-size="14" text-anchor="middle">1</text>
  <rect x="300" y="150" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="320" y="170" font-size="14" text-anchor="middle">4</text>
  <text x="360" y="170" font-size="12">→ 入れ替え</text>
  
  <text x="70" y="200" font-size="12">結果: [3, 5, 8, 1, 4]</text>
  
  <!-- j=1 -->
  <text x="70" y="230" font-size="12">j=1: 比較 [5 vs 8]</text>
  <rect x="100" y="240" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="120" y="260" font-size="14" text-anchor="middle">3</text>
  <rect x="150" y="240" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="170" y="260" font-size="14" text-anchor="middle">5</text>
  <rect x="200" y="240" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="220" y="260" font-size="14" text-anchor="middle">8</text>
  <rect x="250" y="240" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="270" y="260" font-size="14" text-anchor="middle">1</text>
  <rect x="300" y="240" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="320" y="260" font-size="14" text-anchor="middle">4</text>
  <text x="360" y="260" font-size="12">→ そのまま</text>
  
  <!-- j=2 -->
  <text x="70" y="300" font-size="12">j=2: 比較 [8 vs 1]</text>
  <rect x="100" y="310" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="120" y="330" font-size="14" text-anchor="middle">3</text>
  <rect x="150" y="310" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="170" y="330" font-size="14" text-anchor="middle">5</text>
  <rect x="200" y="310" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="220" y="330" font-size="14" text-anchor="middle">8</text>
  <rect x="250" y="310" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="270" y="330" font-size="14" text-anchor="middle">1</text>
  <rect x="300" y="310" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="320" y="330" font-size="14" text-anchor="middle">4</text>
  <text x="360" y="330" font-size="12">→ 入れ替え</text>
  
  <!-- j=3 -->
  <text x="70" y="370" font-size="12">j=3: 比較 [8 vs 4]</text>
  <rect x="100" y="380" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="120" y="400" font-size="14" text-anchor="middle">3</text>
  <rect x="150" y="380" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="170" y="400" font-size="14" text-anchor="middle">5</text>
  <rect x="200" y="380" width="40" height="30" fill="#e0e0e0" stroke="black"/>
  <text x="220" y="400" font-size="14" text-anchor="middle">1</text>
  <rect x="250" y="380" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="270" y="400" font-size="14" text-anchor="middle">8</text>
  <rect x="300" y="380" width="40" height="30" fill="#ff6b6b" stroke="black"/>
  <text x="320" y="400" font-size="14" text-anchor="middle">4</text>
  <text x="360" y="400" font-size="12">→ 入れ替え</text>
  
  <text x="70" y="430" font-size="12" font-weight="bold">i=0終了: [3, 5, 1, 4, 8] ← 最大値8が右端に確定!</text>
  
  <!-- 外側ループ i=1 -->
  <text x="50" y="470" font-size="14" fill="#0066cc" font-weight="bold">■ 外側ループ i=1 (2周目)</text>
  
  <text x="70" y="500" font-size="12">j=0: [3 vs 5] → そのまま</text>
  <text x="70" y="520" font-size="12">j=1: [5 vs 1] → 入れ替え → [3, 1, 5, 4, 8]</text>
  <text x="70" y="540" font-size="12">j=2: [5 vs 4] → 入れ替え → [3, 1, 4, 5, 8]</text>
  <text x="70" y="560" font-size="12" font-weight="bold">i=1終了: [3, 1, 4, 5, 8] ← 次の最大値5が確定!</text>
  
  <!-- 外側ループ i=2 -->
  <text x="50" y="600" font-size="14" fill="#0066cc" font-weight="bold">■ 外側ループ i=2 (3周目)</text>
  
  <text x="70" y="630" font-size="12">j=0: [3 vs 1] → 入れ替え → [1, 3, 4, 5, 8]</text>
  <text x="70" y="650" font-size="12">j=1: [3 vs 4] → そのまま</text>
  <text x="70" y="670" font-size="12" font-weight="bold">i=2終了: [1, 3, 4, 5, 8] ← 次の最大値4が確定!</text>
  
  <!-- 外側ループ i=3 -->
  <text x="50" y="710" font-size="14" fill="#0066cc" font-weight="bold">■ 外側ループ i=3 (4周目)</text>
  
  <text x="70" y="740" font-size="12">j=0: [1 vs 3] → そのまま</text>
  <text x="70" y="760" font-size="12" font-weight="bold">i=3終了: [1, 3, 4, 5, 8] ← 完成!</text>
  
  <!-- ループの回数説明 -->
  <rect x="50" y="790" width="700" height="90" fill="#fff9e6" stroke="#ffa500" stroke-width="2"/>
  <text x="70" y="815" font-size="14" font-weight="bold">ポイント:</text>
  <text x="70" y="835" font-size="12">• 外側ループ(i): 配列の長さ-1回 (5要素なら4回)</text>
  <text x="70" y="855" font-size="12">• 内側ループ(j): 毎回、確定した要素を除いて比較</text>
  <text x="70" y="875" font-size="12">  → j &lt; arr.length - 1 - i で、右端の確定済み要素をスキップ</text>
</svg>