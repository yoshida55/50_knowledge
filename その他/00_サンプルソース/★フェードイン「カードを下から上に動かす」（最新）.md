# フェードイン「カードを下から上に動かす」（最新版）

スクロールで要素が画面内に入ったら、下から上にフェードインするアニメーション。



実際どのようなスクロール幅、画面のウィンドウサイズと
２００PX（ターゲットがウィンドウの下から200pxの位置）の関係をアニメーション
[プレビュー](http://localhost:54321/preview-20260215-112528.html)



★ようするに式を覚える。ターゲット位置よりスクロール量がふえたら発火する（Windows縦幅＋200）

if (scroll > target - windowHeight + 200) {



## ★重要ポイント

【★ポイント1: jQuery読込確認必須】
```html
<!-- CDN -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- またはローカル -->
<script src="jquery.min.js"></script>

<!-- work.jsより前に配置必須 -->
<script src="js/work.js"></script>
```

【★ポイント2: `:not(.is-visible)` 除外構文】
`.is-visibleクラスが無い要素だけ処理`することで、一度表示した要素は次回スキップされる。


【★ポイント3: 動的クラス追加で完了判定】
条件を満たしたら`is-visible`クラスを追加。次回ループ時は`:not(.is-visible)`で除外される仕組み。

【★ポイント4: ページ読込時チェック必須】
`$(document).ready()`で初回チェックしないと、最初から見える位置にある要素が動かない。

【★ポイント5: CSS初期状態】
`opacity: 0` + `transform: translateY(2rem)` で下に配置してから、JSで`opacity: 1` + `translateY(0)`にする。

---

## HTML

```html
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>スクロールアニメーション</title>
  <link rel="stylesheet" href="css/work.css">
</head>
<body>
  <!-- アニメーション対象 -->
  <div class="news_title_container">
    <h2 class="news_title">お知らせ</h2>
    <p class="news_msg">最新情報をお届けします</p>
  </div>

  <!-- jQuery読み込み（CDN） -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- work.jsはjQueryより後に配置 -->
  <script src="js/work.js"></script>
</body>
</html>
```

---

## CSS

```css
/* タイトルと説明のコンテナ */
.news_title_container {
  flex: 1.5;
  display: flex;
  text-align: right;
  justify-content: flex-end;
  align-items: flex-start;

  /* ★アニメーション初期状態 */
  opacity: 0;
  transform: translateY(2rem); /* 下に配置 */
  transition: all 0.5s ease;
}

.news_title {
  font-size: 3rem;
  writing-mode: vertical-rl;
}

.news_msg {
  writing-mode: vertical-rl;
}
```

---

## JavaScript

```javascript
// スクロールアニメーション関数
function checkNewsAnimation() {
  // ★初めて表示されたときのみ実行される
  // :not(.is-visible) = .is-visibleクラスが無い要素だけ処理
  $(".news_title_container:not(.is-visible)").each(function () {
    let scroll = $(window).scrollTop();      // スクロールした距離
    let target = $(this).offset().top;       // この要素までの距離
    let windowHeight = $(window).height();   // 画面の高さ

    // ★ターゲットがウィンドウの下から200pxの位置に来たらアニメーションを開始
    if (scroll > target - windowHeight + 200) {
      // ★完了済みのクラスを追加。アニメーションを開始。jsでcssのプロパティを変更
      $(this).addClass("is-visible");
      $(this).css({
        opacity: "1",
        transform: "translateY(0)",
      });
    }
  });
}


// ★スクロール時
$(window).scroll(checkNewsAnimation);

// ★ページ読込時も実行（最初から見える要素に対応）
$(document).ready(checkNewsAnimation);
```

---

## 動作フロー

1. **初期状態（CSS）**
   - `opacity: 0` で非表示
   - `transform: translateY(2rem)` で下に配置

2. **ページ読込時（JS）**
   - `$(document).ready()` で初回チェック
   - 画面内にあれば即座に表示

3. **スクロール時（JS）**
   - 要素が画面下から200px入った位置で検知
   - `is-visible` クラス追加
   - `opacity: 1` + `translateY(0)` で表示

4. **次回ループ**
   - `:not(.is-visible)` により除外
   - 重複処理を防止してパフォーマンス向上

---

## トラブルシューティング

### エラー: `$ is not defined`
**原因**: jQuery未読込
**対処**: HTMLで`<script src="jquery..."></script>`を`work.js`より前に配置

### 症状: 最初から見える要素が動かない
**原因**: ページ読込時にチェックしていない
**対処**: `$(document).ready(checkNewsAnimation);` を追加

### 症状: スクロールがカクつく
**原因**: 表示済み要素も毎回処理している
**対処**: `:not(.is-visible)` で除外 + `addClass("is-visible")` で完了フラグ
